(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80a2f678"],{"1da1":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("d3b7");function a(e,t,n,a,o,r,c){try{var l=e[r](c),i=l.value}catch(s){return void n(s)}l.done?t(i):Promise.resolve(i).then(a,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var c=e.apply(t,n);function l(e){a(c,o,r,l,i,"next",e)}function i(e){a(c,o,r,l,i,"throw",e)}l(void 0)}))}}},a4c8:function(e,t,n){"use strict";n.r(t);n("b0c0");var a=n("7a23"),o=Object(a["createElementVNode"])("p",{class:"tip"},"增删改查完整示例",-1),r={class:"demo-code"},c=Object(a["createTextVNode"])("      "),l=Object(a["createTextVNode"])("\r\n      "),i=Object(a["createTextVNode"])("\r\n    ");function s(e,t,n,s,u,d){var v=Object(a["resolveComponent"])("vxe-button"),m=Object(a["resolveComponent"])("vxe-toolbar"),p=Object(a["resolveComponent"])("vxe-column"),b=Object(a["resolveComponent"])("vxe-input"),x=Object(a["resolveComponent"])("vxe-select"),f=Object(a["resolveComponent"])("vxe-table"),w=Object(a["resolveComponent"])("pre-code");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[o,Object(a["createVNode"])(m,{ref:"xToolbar",loading:e.demo1.loading},{buttons:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(v,{status:"primary",content:"临时新增",onClick:e.insertEvent},null,8,["onClick"]),Object(a["createVNode"])(v,{status:"warning",content:"临时删除",onClick:e.removeSelectEvent},null,8,["onClick"]),Object(a["createVNode"])(v,{status:"danger",content:"直接删除",onClick:e.deleteSelectEvent},null,8,["onClick"]),Object(a["createVNode"])(v,{content:"提交（将临时操作持久化）",onClick:e.saveEvent},null,8,["onClick"])]})),_:1},8,["loading"]),Object(a["createVNode"])(f,{border:"",resizable:"","show-overflow":"","keep-source":"",ref:"xTable",height:"500",loading:e.demo1.loading,data:e.demo1.tableData,"edit-rules":e.demo1.validRules,"edit-config":{trigger:"click",mode:"row",showUpdateStatus:!0,showInsertStatus:!0}},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(p,{type:"checkbox",width:"60"}),Object(a["createVNode"])(p,{field:"name",title:"Name","edit-render":{}},{edit:Object(a["withCtx"])((function(e){var t=e.row;return[Object(a["createVNode"])(b,{modelValue:t.name,"onUpdate:modelValue":function(e){return t.name=e},type:"text"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),Object(a["createVNode"])(p,{field:"nickname",title:"Nickname","edit-render":{}},{edit:Object(a["withCtx"])((function(e){var t=e.row;return[Object(a["createVNode"])(b,{modelValue:t.nickname,"onUpdate:modelValue":function(e){return t.nickname=e},type:"text"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),Object(a["createVNode"])(p,{field:"sex",title:"Sex","edit-render":{}},{default:Object(a["withCtx"])((function(t){var n=t.row;return[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(e.formatSex(n.sex)),1)]})),edit:Object(a["withCtx"])((function(t){var n=t.row;return[Object(a["createVNode"])(x,{modelValue:n.sex,"onUpdate:modelValue":function(e){return n.sex=e},type:"text",options:e.demo1.sexList,transfer:""},null,8,["modelValue","onUpdate:modelValue","options"])]})),_:1}),Object(a["createVNode"])(p,{field:"amount",title:"Amount","edit-render":{}},{edit:Object(a["withCtx"])((function(e){var t=e.row;return[Object(a["createVNode"])(b,{modelValue:t.amount,"onUpdate:modelValue":function(e){return t.amount=e},type:"float",digits:2},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),Object(a["createVNode"])(p,{field:"updateDate",title:"Date","edit-render":{}},{edit:Object(a["withCtx"])((function(e){var t=e.row;return[Object(a["createVNode"])(b,{modelValue:t.updateDate,"onUpdate:modelValue":function(e){return t.updateDate=e},type:"date"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),Object(a["createVNode"])(p,{title:"操作",width:"240"},{default:Object(a["withCtx"])((function(t){var n=t.row;return[Object(a["createVNode"])(v,{status:"warning",content:"临时删除",onClick:function(t){return e.removeRowEvent(n)}},null,8,["onClick"]),Object(a["createVNode"])(v,{status:"danger",content:"直接删除",onClick:function(t){return e.deleteRowEvent(n)}},null,8,["onClick"])]})),_:1})]})),_:1},8,["loading","data","edit-rules"]),Object(a["createElementVNode"])("p",r,Object(a["toDisplayString"])(e.$t("app.body.button.showCode")),1),Object(a["createElementVNode"])("pre",null,[c,Object(a["createVNode"])(w,{class:"xml"},{default:Object(a["withCtx"])((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.demoCodes[0]),1)]})),_:1}),l,Object(a["createVNode"])(w,{class:"javascript"},{default:Object(a["withCtx"])((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.demoCodes[1]),1)]})),_:1}),i])])}var u=n("1da1"),d=(n("96cf"),n("d3b7"),n("e9c4"),n("99af"),n("5502")),v=n("55db"),m=Object(a["defineComponent"])({setup:function(){var e=Object(d["b"])(),t=Object(a["computed"])((function(){return e.state.serveApiUrl})),n=Object(a["ref"])({}),o=Object(a["ref"])({}),r=Object(a["reactive"])({loading:!1,tableData:[],validRules:{name:[{required:!0,message:"名称必须填写"}]},sexList:[{label:"男",value:"1"},{label:"女",value:"0"}]}),c=function(e){return"1"===e?"男":"0"===e?"女":""},l=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.loading=!0,e.prev=1,e.next=4,fetch("".concat(t.value,"/api/pub/all")).then((function(e){return e.json()}));case 4:n=e.sent,r.tableData=n,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),r.tableData=[];case 11:r.loading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.value,n={},e.next=4,t.insert(n);case 4:return a=e.sent,r=a.row,e.next=8,t.setActiveRow(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.value,e.next=3,t.removeCheckboxRow();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var n,a,c,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v["a"].modal.confirm("您确定要删除选中的数据?");case 2:if(n=e.sent,"confirm"===n){e.next=5;break}return e.abrupt("return");case 5:return a=o.value,c=a.getCheckboxRecords(),r.loading=!0,e.prev=8,i={removeRecords:c},e.next=12,fetch("".concat(t.value,"/api/pub/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});case 12:return e.next=14,l();case 14:e.next=18;break;case 16:e.prev=16,e.t0=e["catch"](8);case 18:r.loading=!1;case 19:case"end":return e.stop()}}),e,null,[[8,16]])})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=o.value,e.next=3,n.remove(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(n){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v["a"].modal.confirm("您确定要删除该数据?");case 2:if(a=e.sent,"confirm"===a){e.next=5;break}return e.abrupt("return");case 5:return r.loading=!0,e.prev=6,o={removeRecords:[n]},e.next=10,fetch("".concat(t.value,"/api/pub/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 10:return e.next=12,l();case 12:e.next=16;break;case 14:e.prev=14,e.t0=e["catch"](6);case 16:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var n,a,c,i,s,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=o.value,a=n.getRecordset(),c=a.insertRecords,i=a.removeRecords,s=a.updateRecords,!(c.length<=0&&i.length<=0&&s.length<=0)){e.next=5;break}return v["a"].modal.message({content:"数据未改动！",status:"warning"}),e.abrupt("return");case 5:return e.next=7,n.validate();case 7:if(u=e.sent,!u){e.next=10;break}return e.abrupt("return");case 10:return r.loading=!0,e.prev=11,d={insertRecords:c,removeRecords:i,updateRecords:s},e.next=15,fetch("".concat(t.value,"/api/pub/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});case 15:return e.next=17,l();case 17:v["a"].modal.message({content:"操作成功，新增 ".concat(c.length," 条，更新 ").concat(s.length," 条，删除 ").concat(i.length," 条"),status:"success"}),e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](11),e.t0&&e.t0.message&&v["a"].modal.message({content:e.t0.message,status:"error"});case 23:r.loading=!1;case 24:case"end":return e.stop()}}),e,null,[[11,20]])})));return function(){return e.apply(this,arguments)}}();return Object(a["nextTick"])((function(){var e=o.value,t=n.value;e.connect(t)})),l(),{demo1:r,xToolbar:n,xTable:o,formatSex:c,insertEvent:i,removeSelectEvent:s,deleteSelectEvent:m,removeRowEvent:p,deleteRowEvent:b,saveEvent:x,demoCodes:['\n        <vxe-toolbar ref="xToolbar" :loading="demo1.loading">\n          <template #buttons>\n            <vxe-button status="primary" content="临时新增" @click="insertEvent"></vxe-button>\n            <vxe-button status="warning" content="临时删除" @click="removeSelectEvent"></vxe-button>\n            <vxe-button status="danger" content="直接删除" @click="deleteSelectEvent"></vxe-button>\n            <vxe-button content="提交（将临时操作持久化）" @click="saveEvent"></vxe-button>\n          </template>\n        </vxe-toolbar>\n\n        <vxe-table\n          border\n          resizable\n          show-overflow\n          keep-source\n          ref="xTable"\n          height="500"\n          :loading="demo1.loading"\n          :data="demo1.tableData"\n          :edit-rules="demo1.validRules"\n          :edit-config="{trigger: \'click\', mode: \'row\', showUpdateStatus: true, showInsertStatus: true}">\n          <vxe-column type="checkbox" width="60"></vxe-column>\n          <vxe-column field="name" title="Name" :edit-render="{}">\n            <template #edit="{ row }">\n              <vxe-input v-model="row.name" type="text"></vxe-input>\n            </template>\n          </vxe-column>\n          <vxe-column field="nickname" title="Nickname" :edit-render="{}">\n            <template #edit="{ row }">\n              <vxe-input v-model="row.nickname" type="text"></vxe-input>\n            </template>\n          </vxe-column>\n          <vxe-column field="sex" title="Sex" :edit-render="{}">\n            <template #default="{ row }">\n              <span>{{ formatSex(row.sex) }}</span>\n            </template>\n            <template #edit="{ row }">\n              <vxe-select v-model="row.sex" type="text" :options="demo1.sexList" transfer></vxe-select>\n            </template>\n          </vxe-column>\n          <vxe-column field="amount" title="Amount" :edit-render="{}">\n            <template #edit="{ row }">\n              <vxe-input v-model="row.amount" type="float" :digits="2"></vxe-input>\n            </template>\n          </vxe-column>\n          <vxe-column field="updateDate" title="Date" :edit-render="{}">\n            <template #edit="{ row }">\n              <vxe-input v-model="row.updateDate" type="date"></vxe-input>\n            </template>\n          </vxe-column>\n          <vxe-column title="操作" width="240">\n            <template #default="{ row }">\n              <vxe-button status="warning" content="临时删除" @click="removeRowEvent(row)"></vxe-button>\n              <vxe-button status="danger" content="直接删除" @click="deleteRowEvent(row)"></vxe-button>\n            </template>\n          </vxe-column>\n        </vxe-table>\n        ',"\n        import { defineComponent, reactive, ref, nextTick, computed } from 'vue'\n        import { useStore } from 'vuex'\n        import { VXETable, VxeTableInstance, VxeToolbarInstance } from 'vxe-table'\n\n        export default defineComponent({\n          setup () {\n            const store = useStore()\n            const serveApiUrl = computed(() => store.state.serveApiUrl)\n\n            const xToolbar = ref({} as VxeToolbarInstance)\n            const xTable = ref({} as VxeTableInstance)\n\n            const demo1 = reactive({\n              loading: false,\n              tableData: [],\n              validRules: {\n                name: [\n                  { required: true, message: '名称必须填写' }\n                ]\n              },\n              sexList: [\n                { label: '男', value: '1' },\n                { label: '女', value: '0' }\n              ]\n            })\n\n            const formatSex = (value: any) => {\n              if (value === '1') {\n                return '男'\n              }\n              if (value === '0') {\n                return '女'\n              }\n              return ''\n            }\n\n            const loadList = async () => {\n              demo1.loading = true\n              try {\n                const res = await fetch(`${serveApiUrl.value}/api/pub/all`).then(response => response.json())\n                demo1.tableData = res\n              } catch (e) {\n                demo1.tableData = []\n              }\n              demo1.loading = false\n            }\n\n            const insertEvent = async () => {\n              const $table = xTable.value\n              const newRecord = {}\n              const { row: newRow } = await $table.insert(newRecord)\n              await $table.setActiveRow(newRow)\n            }\n\n            const removeSelectEvent = async () => {\n              const $table = xTable.value\n              await $table.removeCheckboxRow()\n            }\n\n            const deleteSelectEvent = async () => {\n              const type = await VXETable.modal.confirm('您确定要删除选中的数据?')\n              if (type !== 'confirm') {\n                return\n              }\n              const $table = xTable.value\n              const checkboxRecords = $table.getCheckboxRecords()\n              demo1.loading = true\n              try {\n                const body = { removeRecords: checkboxRecords }\n                await fetch(`${serveApiUrl.value}/api/pub/save`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) })\n                await loadList()\n              } catch (e) {}\n              demo1.loading = false\n            }\n\n            const removeRowEvent = async (row: any) => {\n              const $table = xTable.value\n              await $table.remove(row)\n            }\n\n            const deleteRowEvent = async (row: any) => {\n              const type = await VXETable.modal.confirm('您确定要删除该数据?')\n              if (type !== 'confirm') {\n                return\n              }\n              demo1.loading = true\n              try {\n                const body = { removeRecords: [row] }\n                await fetch(`${serveApiUrl.value}/api/pub/save`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) })\n                await loadList()\n              } catch (e) {}\n            }\n\n            const saveEvent = async () => {\n              const $table = xTable.value\n              const { insertRecords, removeRecords, updateRecords } = $table.getRecordset()\n              if (insertRecords.length <= 0 && removeRecords.length <= 0 && updateRecords.length <= 0) {\n                VXETable.modal.message({ content: '数据未改动！', status: 'warning' })\n                return\n              }\n              const errMap = await $table.validate()\n              if (errMap) {\n                return\n              }\n              demo1.loading = true\n              try {\n                const body = { insertRecords, removeRecords, updateRecords }\n                await fetch(`${serveApiUrl.value}/api/pub/save`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) })\n                await loadList()\n                VXETable.modal.message({ content: `操作成功，新增 ${insertRecords.length} 条，更新 ${updateRecords.length} 条，删除 ${removeRecords.length} 条`, status: 'success' })\n              } catch (e) {\n                if (e && e.message) {\n                  VXETable.modal.message({ content: e.message, status: 'error' })\n                }\n              }\n              demo1.loading = false\n            }\n\n            nextTick(() => {\n              // 将表格和工具栏进行关联\n              const $table = xTable.value\n              const $toolbar = xToolbar.value\n              $table.connect($toolbar)\n            })\n\n            loadList()\n\n            return {\n              demo1,\n              xToolbar,\n              xTable,\n              formatSex,\n              insertEvent,\n              removeSelectEvent,\n              deleteSelectEvent,\n              removeRowEvent,\n              deleteRowEvent,\n              saveEvent\n            }\n          }\n        })\n        "]}}}),p=n("6b0d"),b=n.n(p);const x=b()(m,[["render",s]]);t["default"]=x}}]);