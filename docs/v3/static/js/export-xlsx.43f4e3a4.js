(window["webpackJsonpVXETable"]=window["webpackJsonpVXETable"]||[]).push([["export-xlsx"],{5734:function(e,t,n){"use strict";function o(e){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=t.VXETablePluginExportXLSX=void 0;var a=u(n("c695")),r=s(n("9ad0"));function l(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=a?Object.getOwnPropertyDescriptor(e,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r]}return n["default"]=e,t&&t.set(e,n),n}function u(e){return e&&e.__esModule?e:{default:e}}var c="f8f8f9",i="606266",m="thin",f="e8eaec";function d(e,t){if(t)switch(e.cellType){case"string":return a["default"].toString(t);case"number":if(!isNaN(t))return Number(t);break;default:if(t.length<12&&!isNaN(t))return Number(t);break}return t}function p(e,t){var n=e.footerFilterMethod;return n?t.filter((function(e,t){return n({items:e,$rowIndex:t})})):t}function x(e,t,n,o){var a=d(o,n[e.getVMColumnIndex(o)]);return a}function b(e){var t=e.childNodes,n=t&&t.length;return n?b(t[0]):e}function v(e,t){t&&(e.height=a["default"].floor(.75*t,12))}function g(e,t){e.protection={locked:!1},e.alignment={vertical:"middle",horizontal:t||"left"}}function h(){return{top:{style:m,color:{argb:f}},left:{style:m,color:{argb:f}},bottom:{style:m,color:{argb:f}},right:{style:m,color:{argb:f}}}}function y(e){var t="xlsx",n=e.$table,o=e.options,l=e.columns,s=e.colgroups,u=e.datas,m=n.$vxe,f=n.rowHeight,y=n.headerAlign,E=n.align,k=n.footerAlign,C=m.modal,_=m.t,N=o.message,S=o.sheetName,I=o.isHeader,D=o.isFooter,T=o.isMerge,O=o.isColgroup,M=o.original,$=o.useStyle,j=o.sheetMethod,X=!1!==N,V=n.getMergeCells(),F=[],B=[],L=[],P=[],A=0,R={};l.forEach((function(e){var t=e.id,n=e.property,o=e.renderWidth;R[t]=M?n:e.getTitle(),L.push({key:t,width:a["default"].ceil(o/8,1)})})),I&&(O&&!M&&s?s.forEach((function(e,t){var n={};l.forEach((function(e){n[e.id]=null})),e.forEach((function(e){var o=e._colSpan,a=e._rowSpan,r=b(e),s=l.indexOf(r);n[r.id]=M?r.property:e.getTitle(),(o>1||a>1)&&P.push({s:{r:t,c:s},e:{r:t+a-1,c:s+o-1}})})),F.push(n)})):F.push(R),A+=F.length),T&&!M&&V.forEach((function(e){var t=e.row,n=e.rowspan,o=e.col,a=e.colspan;P.push({s:{r:t+A,c:o},e:{r:t+A+n-1,c:o+a-1}})}));var G=u.map((function(e){var t={};return l.forEach((function(n){t[n.id]=d(n,e[n.id])})),t}));if(A+=G.length,D){var U=n.getTableData(),W=U.footerData,q=p(o,W),H=n.getMergeFooterItems();T&&!M&&H.forEach((function(e){var t=e.row,n=e.rowspan,o=e.col,a=e.colspan;P.push({s:{r:t+A,c:o},e:{r:t+A+n-1,c:o+a-1}})})),q.forEach((function(e){var t={};l.forEach((function(a){t[a.id]=x(n,o,e,a)})),B.push(t)}))}var J=function(){var a=new r.Workbook,m=a.addWorksheet(S);a.creator="vxe-table",m.columns=L,I&&m.addRows(F).forEach((function(e){$&&v(e,f),e.eachCell((function(e){var t=m.getColumn(e.col),o=n.getColumnById(t.key),a=o.headerAlign,r=o.align;g(e,a||r||y||E),$&&Object.assign(e,{font:{bold:!0,color:{argb:i}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:c}},border:h()})}))})),m.addRows(G).forEach((function(e){$&&v(e,f),e.eachCell((function(e){var t=m.getColumn(e.col),o=n.getColumnById(t.key),a=o.align;g(e,a||E),$&&Object.assign(e,{font:{color:{argb:i}},border:h()})}))})),D&&m.addRows(B).forEach((function(e){$&&v(e,f),e.eachCell((function(e){var t=m.getColumn(e.col),o=n.getColumnById(t.key),a=o.footerAlign,r=o.align;g(e,a||r||k||E),$&&Object.assign(e,{font:{color:{argb:i}},border:h()})}))})),$&&j&&j({options:o,workbook:a,worksheet:m,columns:l,colgroups:s,datas:u,$table:n}),P.forEach((function(e){var t=e.s,n=e.e;m.mergeCells(t.r+1,t.c+1,n.r+1,n.c+1)})),a.xlsx.writeBuffer().then((function(n){var a=new Blob([n],{type:"application/octet-stream"});w(e,a,o),X&&(C.close(t),C.message({message:_("vxe.table.expSuccess"),status:"success"}))}))};X?(C.message({id:t,message:_("vxe.table.expLoading"),status:"loading",duration:-1}),setTimeout(J,1500)):J()}function w(e,t,n){var o=e.$table,a=o.$vxe,r=a.modal,l=a.t,s=n.message,u=n.filename,c=n.type,i=!1!==s;if(window.Blob)if(navigator.msSaveBlob)navigator.msSaveBlob(t,"".concat(u,".").concat(c));else{var m=document.createElement("a");m.target="_blank",m.download="".concat(u,".").concat(c),m.href=URL.createObjectURL(t),document.body.appendChild(m),m.click(),document.body.removeChild(m)}else i&&r.alert({message:l("vxe.error.notExp"),status:"error"})}function E(e,t){return t.some((function(t){return e.indexOf(t)>-1}))}function k(e){var t=e.$table,n=e.options,o=t.$vxe,a=t._importReject,r=!1!==n.message,l=o.modal,s=o.t;r&&l.message({message:s("vxe.error.impFields"),status:"error"}),a&&a({status:!1})}function C(e){var t=e.$table,n=e.columns,o=e.options,l=e.file,s=t.$vxe,u=t._importResolve,c=s.modal,i=s.t,m=!1!==o.message,f=new FileReader;f.onerror=function(){k(e)},f.onload=function(l){var s=[];n.forEach((function(e){var t=e.property;t&&s.push(t)}));var f=new r.Workbook,d=l.target;d?f.xlsx.load(d.result).then((function(n){var r=n.worksheets[0];if(r){var l=r.getSheetValues(),f=a["default"].findIndexOf(l,(function(e){return e&&e.length>0})),d=l[f],p=E(s,d);if(p){var x=l.slice(f).map((function(e){var t={};e.forEach((function(e,n){t[d[n]]=e}));var n={};return s.forEach((function(e){n[e]=a["default"].isUndefined(t[e])?null:t[e]})),n}));t.createData(x).then((function(e){var n;return n="insert"===o.mode?t.insertAt(e,-1):t.reloadData(e),n.then((function(){u&&u({status:!0})}))})),m&&c.message({message:i("vxe.table.impSuccess",[x.length]),status:"success"})}else k(e)}else k(e)})):k(e)},f.readAsArrayBuffer(l)}function _(e){if("xlsx"===e.options.type)return C(e),!1}function N(e){if("xlsx"===e.options.type)return y(e),!1}var S={install:function(e){var t=e.interceptor;e.setup({export:{types:{xlsx:0}}}),t.mixin({"event.import":_,"event.export":N})}};t.VXETablePluginExportXLSX=S,"undefined"!==typeof window&&window.VXETable&&window.VXETable.use&&window.VXETable.use(S);var I=S;t["default"]=I},e0ba:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("vxe-toolbar",{attrs:{custom:"",import:"",export:""},scopedSlots:e._u([{key:"buttons",fn:function(){return[n("vxe-button",{on:{click:function(t){e.tableData=[]}}},[e._v("清空数据")]),n("vxe-button",{on:{click:e.exportDataEvent}},[e._v("导出数据")]),n("vxe-button",{on:{click:function(t){e.align="left"}}},[e._v("居左")]),n("vxe-button",{on:{click:function(t){e.align="center"}}},[e._v("居中")]),n("vxe-button",{on:{click:function(t){e.align="right"}}},[e._v("居右")])]},proxy:!0}])}),n("vxe-table",{ref:"xTable",attrs:{border:"","show-footer":"",height:"500",align:e.align,loading:e.loading,"footer-method":e.footerMethod,"import-config":e.tableImport,"export-config":e.tableExport,"merge-cells":e.mergeCells,"merge-footer-items":e.mergeFooterItems,data:e.tableData}},[n("vxe-table-column",{attrs:{type:"checkbox",width:"60"}}),n("vxe-table-column",{attrs:{type:"seq",width:"60"}}),n("vxe-table-colgroup",{attrs:{title:"Group1"}},[n("vxe-table-column",{attrs:{field:"name",title:"名称"}}),n("vxe-table-column",{attrs:{field:"date1",title:"日期"}}),n("vxe-table-colgroup",{attrs:{title:"Group2"}},[n("vxe-table-column",{attrs:{field:"sex",title:"格式化",formatter:e.formatterSex}}),n("vxe-table-column",{attrs:{field:"num",title:"数值-默认"}})],1)],1),n("vxe-table-colgroup",{attrs:{title:"Group1"}},[n("vxe-table-column",{attrs:{field:"num1",title:"数值-数值","cell-type":"number"}}),n("vxe-table-column",{attrs:{field:"num2",title:"数值-字符串","cell-type":"string"}})],1)],1),n("p",{staticClass:"demo-code"},[e._v(e._s(e.$t("app.body.button.showCode")))]),n("pre",[e._v("    "),n("pre-code",{staticClass:"xml"},[e._v(e._s(e.demoCodes[0]))]),e._v("\n    "),n("pre-code",{staticClass:"javascript"},[e._v(e._s(e.demoCodes[1]))]),e._v("\n  ")],1)],1)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",{staticClass:"tip"},[e._v(" 具体兼容请查看 "),n("a",{staticClass:"link",attrs:{href:"https://github.com/x-extends/vxe-table-plugin-export-xlsx",target:"_blank"}},[e._v("vxe-table-plugin-export-xlsx")]),e._v(" 插件的 API"),n("br"),n("span",{staticClass:"red"},[e._v("（注：该示例仅供参考，建议使用后端导出）")])])}],r=(n("159b"),n("c695")),l=n.n(r),s={data:function(){return{loading:!1,align:null,tableData:[],tableImport:{types:["xlsx"]},tableExport:{type:"xlsx",types:["xlsx","csv","html","xml","txt"]},mergeCells:[],mergeFooterItems:[],demoCodes:['\n        <vxe-toolbar custom import export>\n          <template #buttons>\n            <vxe-button @click="tableData = []">清空数据</vxe-button>\n            <vxe-button @click="exportDataEvent">导出数据</vxe-button>\n            <vxe-button @click="align = \'left\'">居左</vxe-button>\n            <vxe-button @click="align = \'center\'">居中</vxe-button>\n            <vxe-button @click="align = \'right\'">居右</vxe-button>\n          </template>\n        </vxe-toolbar>\n\n        <vxe-table\n          border\n          show-footer\n          ref="xTable"\n          height="500"\n          :align="align"\n          :loading="loading"\n          :footer-method="footerMethod"\n          :import-config="tableImport"\n          :export-config="tableExport"\n          :merge-cells="mergeCells"\n          :merge-footer-items="mergeFooterItems"\n          :data="tableData">\n          <vxe-table-column type="checkbox" width="60"></vxe-table-column>\n          <vxe-table-column type="seq" width="60"></vxe-table-column>\n          <vxe-table-colgroup title="Group1">\n            <vxe-table-column field="name" title="名称"></vxe-table-column>\n            <vxe-table-column field="date1" title="日期"></vxe-table-column>\n            <vxe-table-colgroup title="Group2">\n              <vxe-table-column field="sex" title="格式化" :formatter="formatterSex"></vxe-table-column>\n              <vxe-table-column field="num" title="数值-默认"></vxe-table-column>\n            </vxe-table-colgroup>\n          </vxe-table-colgroup>\n          <vxe-table-colgroup title="Group1">\n            <vxe-table-column field="num1" title="数值-数值" cell-type="number"></vxe-table-column>\n            <vxe-table-column field="num2" title="数值-字符串" cell-type="string"></vxe-table-column>\n          </vxe-table-colgroup>\n        </vxe-table>\n        ',"\n        import XEUtils from 'xe-utils'\n        \n        export default {\n          data () {\n            return {\n              loading: false,\n              align: null,\n              tableData: [],\n              tableImport: {\n                // 自定义类型\n                types: ['xlsx']\n              },\n              tableExport: {\n                // 默认选中类型\n                type: 'xlsx',\n                // 自定义类型\n                types: ['xlsx', 'csv', 'html', 'xml', 'txt']\n              },\n              mergeCells: [],\n              mergeFooterItems: []\n            }\n          },\n          created () {\n            this.findList()\n          },\n          methods: {\n            findList () {\n              this.loading = true\n              setTimeout(() => {\n                this.tableData = [\n                  { name: 'name1', role: 'role1', rate: 1, date1: '2021-06-02 10:05:20', sex: '0', num: '22', num1: '22', num2: '22', cardNo: '998' },\n                  { name: 'name2', role: 'role2', rate: 1, date1: '2021-01-28 16:05:28', sex: '1', num: 32, num1: 32, num2: 32, cardNo: 10000 },\n                  { name: 'name3', role: 'role3', rate: 6, date1: '2021-05-04 11:05:48', sex: '1', num: 99999999999999, num1: 99999999999999, num2: 99999999999999, cardNo: '62221234219637458563' },\n                  { name: 'name4', role: 'role4', rate: 3, date1: '2021-07-02 08:05:23', sex: '0', num: '999.99', num1: '999.99', num2: '999.99', cardNo: '62227412123789459631' },\n                  { name: 'name5', role: 'role5', rate: 1, date1: '2021-02-15 05:05:20', sex: '1', num: -1, num1: -1, num2: -1, cardNo: '62221234214752459631' },\n                  { name: 'name6', role: 'role6', rate: 4, date1: '2021-12-02 01:05:33', sex: '1', num: '10000', num1: '10000', num2: '10000', cardNo: '62221267214853659622' },\n                  { name: 'name7', role: 'role7', rate: 1, date1: '2021-09-22 23:22:41', sex: '1', num: 10000000000000.001, num1: 10000000000000.001, num2: 10000000000000.001, cardNo: '62221237123480359633' },\n                  { name: 'name8', role: 'role8', rate: 5, date1: '2021-11-02 22:08:27', sex: '2', num: 9998, num1: 9998, num2: 9998, cardNo: '62221234018523736237' },\n                  { name: 'name9', role: 'role9', rate: 8, date1: '2021-01-02 14:05:52', sex: '1', num: 70000, num1: 70000, num2: 70000, cardNo: '62221230283686397412' }\n                ]\n                this.mergeFooterItems = [\n                  { row: 0, col: 1, rowspan: 2, colspan: 2 },\n                  { row: 1, col: 5, rowspan: 1, colspan: 3 }\n                ]\n                this.loading = false\n              }, 100)\n            },\n            formatterSex ({ cellValue }) {\n              return cellValue ? (cellValue === '1' ? '男' : '女') : ''\n            },\n            exportDataEvent () {\n              this.$refs.xTable.exportData({\n                filename: '导出',\n                sheetName: 'Sheet1',\n                type: 'xlsx'\n              })\n            },\n            footerMethod ({ columns, data }) {\n              const means = []\n              const sums = []\n              columns.forEach((column, columnIndex) => {\n                if (columnIndex === 0) {\n                  means.push('平均')\n                  sums.push('和值')\n                } else {\n                  let meanCell = '-'\n                  let sumCell = '-'\n                  switch (column.property) {\n                    case 'rate':\n                    case 'num':\n                    case 'num1':\n                    case 'num2':\n                      meanCell = parseInt(XEUtils.mean(data, column.property))\n                      sumCell = XEUtils.sum(data, column.property)\n                      break\n                  }\n                  means.push(meanCell)\n                  sums.push(sumCell)\n                }\n              })\n              // 返回一个二维数组的表尾合计\n              return [means, sums]\n            }\n          }\n        }\n        "]}},created:function(){this.findList()},methods:{findList:function(){var e=this;this.loading=!0,setTimeout((function(){e.tableData=[{name:"name1",role:"role1",rate:1,date1:"2021-06-02 10:05:20",sex:"0",num:"22",num1:"22",num2:"22",cardNo:"998"},{name:"name2",role:"role2",rate:1,date1:"2021-01-28 16:05:28",sex:"1",num:32,num1:32,num2:32,cardNo:1e4},{name:"name3",role:"role3",rate:6,date1:"2021-05-04 11:05:48",sex:"1",num:99999999999999,num1:99999999999999,num2:99999999999999,cardNo:"62221234219637458563"},{name:"name4",role:"role4",rate:3,date1:"2021-07-02 08:05:23",sex:"0",num:"999.99",num1:"999.99",num2:"999.99",cardNo:"62227412123789459631"},{name:"name5",role:"role5",rate:1,date1:"2021-02-15 05:05:20",sex:"1",num:-1,num1:-1,num2:-1,cardNo:"62221234214752459631"},{name:"name6",role:"role6",rate:4,date1:"2021-12-02 01:05:33",sex:"1",num:"10000",num1:"10000",num2:"10000",cardNo:"62221267214853659622"},{name:"name7",role:"role7",rate:1,date1:"2021-09-22 23:22:41",sex:"1",num:10000000000000.002,num1:10000000000000.002,num2:10000000000000.002,cardNo:"62221237123480359633"},{name:"name8",role:"role8",rate:5,date1:"2021-11-02 22:08:27",sex:"2",num:9998,num1:9998,num2:9998,cardNo:"62221234018523736237"},{name:"name9",role:"role9",rate:8,date1:"2021-01-02 14:05:52",sex:"1",num:7e4,num1:7e4,num2:7e4,cardNo:"62221230283686397412"}],e.mergeCells=[{row:1,col:1,rowspan:2,colspan:2},{row:4,col:3,rowspan:1,colspan:3}],e.mergeFooterItems=[{row:0,col:1,rowspan:2,colspan:2},{row:1,col:5,rowspan:1,colspan:3}],e.loading=!1}),100)},formatterSex:function(e){var t=e.cellValue;return t?"1"===t?"男":"女":""},exportDataEvent:function(){this.$refs.xTable.exportData({filename:"导出",sheetName:"Sheet1",type:"xlsx"})},footerMethod:function(e){var t=e.columns,n=e.data,o=[],a=[];return t.forEach((function(e,t){if(0===t)o.push("平均"),a.push("和值");else{var r="-",s="-";switch(e.property){case"rate":case"num":case"num1":case"num2":r=parseInt(l.a.mean(n,e.property)),s=l.a.sum(n,e.property);break}o.push(r),a.push(s)}})),[o,a]}}},u=s,c=n("2877"),i=Object(c["a"])(u,o,a,!1,null,null,null);t["default"]=i.exports}}]);